## 스레드(Thread)

> 프로세스의 최소 실행 단위이자 CPU 수행의 기본 단위

- 한 프로세스 내에서 동작되는 여러 실행 흐름으로 프로세스의 주소 공간이나 자원을 공유한다.
- 독립적인 작업을 수행해야 하기 때문에 스레드마다 고유의 스택과 PC 레지스터 값을 갖는다.

## Context Switching과 동시성

CPU가 싱글 코어라면 한 번에 하나의 프로세스만 실행이 가능하다. 따라서 하나의 CPU가 여러 작업을 수행할 수 있도록 CPU 스케줄링을 통해 작업을 번갈아 가며 수행한다. 이 속도가 굉장히 빠르기 때문에 동시에 실행되는 것처럼 보인다.

이렇게 작업이 동시에 실행되는 것처럼 보이는 것을 **동시성(Concurrency)** 이라 하며 작업을 전환할 때 CPU의 내부 데이터를 교체하는 과정을 **Context Switching** 이라 한다.

## 멀티 스레드

<img src="https://user-images.githubusercontent.com/62097867/202396873-360af097-ee95-48a4-9e59-36b026ff54da.png" width="400px" />

📌 **싱글 스레드(Single thread)**
프로세스가 하나의 스레드를 이용하여 한 번에 한 작업만 수행한다.

📌 **멀티 스레드(Multi thread)**
여러 스레드로 동시에 여러 작업을 수행한다.

### **멀티스레드의 장점**

- **응답성(responsivieness)** : 스레드중 하나가 block되거나 long-running 작업을 수행하는 경우에도 다른 스레드들이 실행되고 있기 때문에 사용자는 interative한 프로그램을 사용할 수 있다.
- **자원 공유(resource sharing)** : 프로세스간 데이터 교환은 IPC를 통해 이루어지지만 스레드는 프로세스의 메모리 공간을 공유하기 때문에 간단하게 이루어진다.
- **경제성(economy)**
  - 스레드는 프로세스의 메모리와 자원을 공유하기 때문에 메모리와 자원을 효율적으로 이용할 수 있다.
  - 프로세스보다 context switching 오버헤드가 적다.
    - 스레드 전환시 CPU는 스택 영역의 주소와 레지스터만 변경하면 된다.
    - 프로세스는 데이터를 공유하지 않으므로 캐시 메모리를 또한 비워야 한다.
    - <details><summary>🔎 캐시란?</summary>
      캐시는 CPU와 메인메모리 사이에 위치하며 CPU가 한번 이상 읽어들인 데이터를 저장해두는 임시 장소이다. CPU가 해당 데이터를 다시 요구한다면 메인 메모리 대신 캐시로부터 데이터를 전달받을 수 있다. </details>
- **확장성(scalability)** : 멀티 프로세서 구조에서는 각각의 스레드가 다른 프로세스에서 병렬로 수행될 수 있으므로 병렬성이 증가한다.

### **멀티스레드의 문제점**

- 스레드 하나에 문제가 생긴다면 전체 프로세스에 영향을 미친다.
- 자원을 공유하므로 동기화 문제가 발생할 수 있어 이에 대한 처리가 필요하다.
