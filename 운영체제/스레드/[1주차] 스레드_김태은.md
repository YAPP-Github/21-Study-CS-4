# 프로세스와 쓰레드가 무엇인가요?

- 프로세스: 컴퓨터에서 실행중인 프로그램
- 쓰레드: 독립적인 흐름을 가진 프로세스의 실행 단위
- 프로그램: 어떤 작업을 수행하는 일련의 명령어의 모음

# 프로세스란?

: 메모리에 올라와 실행되고 있는 프로그램의 인스턴스 (독립적인 개체)

- 할당 받는 시스템 자원
  - Code, Data, Stack, Heap 구조로 이루어져있는 독립된 메모리 영역
  - CPU 사용 시간
  - 운영되기 위해 필요한 주소 공간
- 프로세스당 최소 1개의 쓰레드를 가지고 있음
- 각 프로세스는 별도의 주소 공간에서 실행되며, 한 프로세스는 다른 프로세스의 변수나 자료구조에 접근할 수 없음 - 다른 프로세스에 접근하기 위해선 IPC(Inter Process Communication)을 사용해야 함
  ![Untitled](https://user-images.githubusercontent.com/55427367/191066730-f3fc982e-cf9d-4b48-89ad-568ee718436d.png)

# 쓰레드란?

: 프로세스로 실행되는 프로그램의 일부를 실행하는 프로세스의 실행 단위

- 스레드는 스레드 ID, 프로그램 카운터, 레지스터 집합, 스택으로 구성
- 스레드끼리 code, data, heap 영역 공유
- 스택, PC Register은 독립적으로 할당
  - 스택은 함수 호출 시 전달되는 인자, 되돌아 갈 주소값 및 함수 내에서 선언되는 변수를 저장하기 위해 사용되는 메모리 공간
  - 독립적인 실행 흐름을 추가하기 위한 최소 조건으로 독립된 스택을 할당
  - PC 값은 스레드가 명령어를 어디까지 수행했는지 나타냄
  - 명령어가 연속적으로 수행되지 않기 때문에 어느 부분까지 수행되었는지 기억할 필요가 있기 때문에 독립적으로 할당
- 동기화 문제
  ![Untitled](https://user-images.githubusercontent.com/55427367/191066774-621a3e3a-17d7-41ce-ad7a-2b32312a81c2.png)

# 멀티 스레드와 멀티 프로세스의 차이

- 멀티 스레드: 하나의 프로세스를 여러 개의 스레드로 구성하여 하나의 응용 프로그램을 실행하는 것
- 멀티 프로세스: 여러 개의 프로세스로 하나의 응용 프로그램을 실행
- CPU가 싱글 코어일 때 동시에 실행되는 것처럼 보이기 위해, 실행 단위는 시분할로 CPU를 점유하여 context switching 진행
- 실행 단위: CPU 코어에서 실행하는 하나의 단위로, 프로세스와 스레드를 포괄하는 개념

1. 메모리 공간 공유 여부
   - 멀티 스레드: code, data, heap 공유, 각자 stack 사용
   - 멀티 프로세스: 공유 X
2. 차지하는 메모리 공간 크기
   - 멀티 스레드: 자원을 공유해 상대적으로 덜 차지
   - 멀티 프로세스: 각 프로세스 마다 다른 메모리 영역을 할당 받아 메모리 공간을 많이 차지
3. 동기화 문제
   - 멀티 스레드: 자원을 공유해 여러 개의 스레드가 동일한 자원에 접근할 수 있기 때문에 동기화 처리가 잘 되어야 함
   - 멀티 프로세스: 자원을 공유하지 않기 때문에 문제 없음
4. Context Switching 비용
   - 멀티 스레드: 자원을 공유해 비용이 상대적으로 작음
   - 멀티 프로세스: 자원을 공유하지 않아 상대적으로 큼
5. 통신 방법
   - 멀티 스레드: 별도의 방법 없이 공유 자원 이용
   - 멀티 프로세스: IPC
6. 한 실행 단위가 죽었을 때
   - 멀티 스레드: 다른 스레드들이 영향을 받음
   - 멀티 프로세스: 다른 프로세스들이 영향을 받지 않음

[https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html](https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html)

## Context Switching이란?

- CPU를 한 프로세스에서 다른 프로세스로 넘겨주는 과정
- 다른 프로세스에게 CPU를 넘겨주기 위해 기존 프로세스의 상태를 PCB(Process Control Block)에 저장하고
- 새로운 프로세스의 PCB로부터 데이터를 읽어와 해당 프로세스의 기존 상태(이전에 종료됐던 시점)를 복구하는 작업
- 스레드도 Context Switching이 일어나지만 TCB(Thread Control Block)에 비교적 적은 정보가 저장됨

## PCB와 TCB란?

- PCB(Process Control Block): 운영체제가 각 프로세스를 관리하기 위해 프로세스당 유지하는 정보를 저장하는 자료구조
  - 프로세스 식별자(PID)
  - 프로세스 상태: `new` `ready` `running` `waiting` `terminated` 등
  - 프로그램 카운터: 프로세스가 다음에 실행할 명령어의 주소
  - CPU 레지스터: 일반적으로 현재 계산을 수행중인 값을 저장하는 데 이용되는 아주 빠른 기억 장소
  - CPU 스케줄링 정보: 프로세스의 우선순위, 스케줄 큐에 대한 포인터 등
  - 메모리 관리 정보: 페이지 테이블 또는 세그먼트 테이블 등과 같은 정보 포함
  - 입출력 상태 정보: 프로세스에 할당된 입출력 장치들과 열린 파일 목록
  - 어카운팅 정보: 사용된 CPU 시간, 시간 제한, 계정 번호 등

![Untitled](https://user-images.githubusercontent.com/55427367/191066893-d429f674-7189-4226-bb23-33375d41a33c.png)

- TCB(Thread Control Block): Thread별로 존재하는 자료구조
  - PC, Register Set, PCB를 가리키는 포인터를 가짐

[https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/OS#프로세스와-스레드의-차이](https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/OS#%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%99%80-%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4)
